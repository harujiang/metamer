<!--
JBoss, Home of Professional Open Source
Copyright 2010, Red Hat, Inc. and individual contributors
by the @authors tag. See the copyright.txt in the distribution for a
full listing of individual contributors.

This is free software; you can redistribute it and/or modify it
under the terms of the GNU Lesser General Public License as
published by the Free Software Foundation; either version 2.1 of
the License, or (at your option) any later version.

This software is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this software; if not, write to the Free
Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
02110-1301 USA, or see the FSF site: http://www.fsf.org.
-->

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:a4j="http://richfaces.org/a4j"
      xmlns:metamer="http://java.sun.com/jsf/composite/metamer" xmlns:rich="http://richfaces.org/rich">

    <ui:composition template="/templates/template.xhtml">

        <ui:define name="head">
            <f:metadata>
                <f:viewParam name="templates" value="#{templateBean.templates}">
                    <f:converter converterId="templatesListConverter" />
                </f:viewParam>
            </f:metadata>
            <h:outputStylesheet library="css" name="a4jQueue.css" />
            <script type="text/javascript">
                var events = 0;
                var updates = 0;
                var requests = 0;

                function addEvent() {
                    events++;
                }
                function addUpdate() {
                    updates++;
                }
                function addRequest() {
                    requests++;
                }

                function printCounts() {
                #{rich:element('events')}.innerHTML=events;
                #{rich:element('updates')}.innerHTML=updates;
                #{rich:element('requests')}.innerHTML=requests;
                }
            </script>
        </ui:define>

        <ui:define name="outOfTemplateBefore">
        </ui:define>

        <ui:define name="component">

            <a4j:queue id="a4jQueue" 
                       ignoreDupResponses="#{a4jQueueBean.attributes['ignoreDupResponses'].value}"
                       name="#{a4jQueueBean.attributes['name'].value}"
                       onbeforedomupdate="#{a4jQueueBean.attributes['onbeforedomupdate'].value}"
                       oncomplete="#{a4jQueueBean.attributes['oncomplete'].value}"
                       onerror="#{a4jQueueBean.attributes['onerror'].value}"
                       onevent="#{a4jQueueBean.attributes['event'].value}"
                       onrequestdequeue="#{a4jQueueBean.attributes['onrequestdequeue'].value}"
                       onrequestqueue="#{a4jQueueBean.attributes['onrequestqueue'].value}"
                       onsubmit="#{a4jQueueBean.attributes['onsubmit'].value}"
                       rendered="#{a4jQueueBean.attributes['rendered'].value}"
                       requestDelay="#{a4jQueueBean.attributes['requestDelay'].value}"
                       status="#{a4jQueueBean.attributes['status'].value}"
                       timeout="#{a4jQueueBean.attributes['timeout'].value}"/>

            <h:panelGrid columns="2">
                <h:outputText value="Type here:" />
                <h:inputText id="input" value="#{a4jQueueBean.text}" onkeyup="addEvent();" disabled="#{not (facesContext.maximumSeverity==null)}">
                    <a4j:ajax onbegin="addRequest();"  event="keyup" render="outtext" oncomplete="printCounts()" onbeforedomupdate="addUpdate()" />
                </h:inputText>

                <h:outputText value="Repeated text:" />
                <h:outputText value="#{a4jQueueBean.text}" id="outtext"
                              style="font-weight:bold;" />
                <h:outputText value="Events count:" />
                <h:outputText value="0" id="events" />
                <h:outputText value="Requests count:" />
                <h:outputText value="0" id="requests" />
                <h:outputText value="DOM updates count:" />
                <h:outputText value="0" id="updates" />
            </h:panelGrid>

        </ui:define>

        <ui:define name="outOfTemplateAfter">
            <metamer:attributes value="#{a4jQueueBean.attributes}" id="attributes" />
        </ui:define>

    </ui:composition>
</html>