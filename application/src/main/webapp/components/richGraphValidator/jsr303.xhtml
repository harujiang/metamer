<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"	
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:metamer="http://java.sun.com/jsf/composite/metamer">

<!--
JBoss, Home of Professional Open Source
Copyright 2010-2011, Red Hat, Inc. and individual contributors
by the @authors tag. See the copyright.txt in the distribution for a
full listing of individual contributors.

This is free software; you can redistribute it and/or modify it
under the terms of the GNU Lesser General Public License as
published by the Free Software Foundation; either version 2.1 of
the License, or (at your option) any later version.

This software is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this software; if not, write to the Free
Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA
02110-1301 USA, or see the FSF site: http://www.fsf.org.
    -->

<ui:composition template="/templates/template.xhtml">

	<ui:define name="view">
		<f:metadata>
			<f:viewParam name="templates" value="#{templateBean.templates}">
				<f:converter converterId="templatesListConverter" />
			</f:viewParam>
		</f:metadata>
	</ui:define>

	<ui:define name="head">
		<style type="text/css">
			.rf-msg-err {
				display: block !important;
				margin-bottom: 6px;
			}			
		</style>
	</ui:define>

	<ui:define name="component">
		<script type="text/javascript">
            function setCorrectValues() {
            	$('input[id$=pass1]').val('rfvokm334lafd');
            	$('input[id$=conf1]').val('rfvokm334lafd');
            }

            function setWrongValues() {
            	$('input[id$=pass1]').val('rfvdthrfd');
            	$('input[id$=conf1]').val('dsararaAqa');
            }
            </script>

		<h:form>
			<input id="setCorrectValuesButton" type="button" value="set correct values" onclick="setCorrectValues()"/>
            <input id="setWrongValuesButton" type="button" value="set wrong values" onclick="setWrongValues()"/>
            
            <br/>
		
			<ui:fragment rendered="#{richGraphValidatorBean.attributes['summary'].value==null 
					|| richGraphValidatorBean.attributes['summary'].value==''}" >
				<rich:graphValidator id="gv1" 
									 value="#{richGraphValidatorBean}"
									 groups="#{richGraphValidatorBean.attributes['groups'].value}"
									 type="#{richGraphValidatorBean.attributes['type'].value}"
									 rendered="#{richGraphValidatorBean.attributes['rendered'].value}" >										
					<rich:panel header="Change password" style="width:500px">
						<rich:messages for="gv1" />
						<rich:messages globalOnly="true" />
						<h:panelGrid columns="3">
							<h:outputText value="Enter new password:" />
							<h:inputSecret value="#{richGraphValidatorBean.password}" id="pass1" />
							<rich:message for="pass1" />
							<h:outputText value="Confirm the new password:" />
							<h:inputSecret value="#{richGraphValidatorBean.passwordConfirm}" id="conf1" />
							<rich:message for="conf1" />
						</h:panelGrid>
						<a4j:commandButton value="Store changes"
							action="#{richGraphValidatorBean.storeNewPassword}" />
					</rich:panel>
				</rich:graphValidator>
			</ui:fragment>
			
			<ui:fragment rendered="#{richGraphValidatorBean.attributes['summary'].value!=null 
									&amp;&amp; richGraphValidatorBean.attributes['summary'].value!=''}" >
				<rich:graphValidator id="gv2"									 
									 value="#{richGraphValidatorBean}"
									 groups="#{richGraphValidatorBean.attributes['groups'].value}"
									 rendered="#{richGraphValidatorBean.attributes['rendered'].value}"
									 summary="#{richGraphValidatorBean.attributes['summary'].value}"
									 type="#{richGraphValidatorBean.attributes['type'].value}" >
					<rich:panel header="Change password" style="width:500px">
						<rich:messages for="gv2" />
						<rich:messages globalOnly="true" />
						<h:panelGrid columns="3">
							<h:outputText value="Enter new password:" />
							<h:inputSecret value="#{richGraphValidatorBean.password}"
								id="pass2" />
							<rich:message for="pass2" />
							<h:outputText value="Confirm the new password:" />
							<h:inputSecret value="#{richGraphValidatorBean.passwordConfirm}"
								id="conf2" />
							<rich:message for="conf2" />
						</h:panelGrid>
						<a4j:commandButton value="Store changes"
							action="#{richGraphValidatorBean.storeNewPassword}" />
					</rich:panel>
				</rich:graphValidator>
			</ui:fragment>
			
		</h:form>

		<br />
		<rich:messages id="msgs" value="#{richGraphValidatorBean}" />

	</ui:define>

	<ui:define name="outOfTemplateAfter">
		<metamer:attributes value="#{richGraphValidatorBean.attributes}"
			id="attributes" />
	</ui:define>
	
</ui:composition>
</html>